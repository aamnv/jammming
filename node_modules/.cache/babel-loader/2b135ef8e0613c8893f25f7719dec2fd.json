{"ast":null,"code":"let accessToken;\nconst clientID = '02e90f8fca6543a8beebe5ca56462a41';\nconst redirectURI = 'http://localhost:3000/';\nconst getAccessTokenURL = \"https://accounts.spotify.com/authorize?client_id=\".concat(clientID, \"&response_type=token&scope=playlist-modify-public&redirect_uri=\").concat(redirectURI);\nconst Spotify = {\n  getAccessToken() {\n    if (accessToken) {\n      return accessToken;\n    }\n\n    const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\n    const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\n\n    if (accessTokenMatch && expiresInMatch) {\n      let accessToken = accessTokenMatch[1];\n      let expirationTime = expiresInMatch[1];\n      window.setTimeout(() => accessToken = '', expirationTime * 1000);\n      window.history.pushState('Access Token', null, '/');\n      return accessToken;\n    } else {\n      window.location = getAccessTokenURL;\n    }\n  },\n\n  search(term) {\n    accessToken = Spotify.getAccessToken();\n\n    if (accessToken) {\n      const fetchURL = \"https://api.spotify.com/v1/search?type=track&q=\".concat(term);\n      const headerInfo = {\n        headers: {\n          Authorization: \"Bearer \".concat(accessToken)\n        }\n      };\n      return fetch(fetchURL, headerInfo).then(response => {\n        if (response.ok) {\n          return response.json();\n        }\n\n        throw new Error('Search request response failed!');\n      }, networkError => console.log(networkError.message)).then(jsonResponse => {\n        if (!jsonResponse.tracks) {\n          return [];\n        } else {\n          return jsonResponse.tracks.items.map(track => {\n            return {\n              id: track.id,\n              name: track.name,\n              artist: track.artists[0].name,\n              album: track.album.name,\n              uri: track.uri\n            };\n          });\n        }\n      });\n    } else {\n      console.log('Failure to get access token in search');\n    }\n  },\n\n  savePlaylist(name, trackUris) {\n    if (!name || !trackUris || trackUris.length === 0) return;\n    const searchURL = searchBase + 'me';\n    const headers = {\n      Authorization: \"Bearer \".concat(accessToken)\n    };\n    let userID;\n    let playlistID;\n    fetch(searchURL, {\n      headers: headers\n    }).then(response => response.json()).then(jsonResponse => userID = jsonResponse.id).then(() => {\n      const createPlaylistUrl = \"\".concat(searchBase, \"users/\").concat(userID, \"/playlists\");\n      fetch(createPlaylistUrl, {\n        method: 'POST',\n        headers: headers,\n        body: JSON.stringify({\n          name: name\n        })\n      }).then(response => response.json()).then(jsonResponse => playlistID = jsonResponse.id).then(() => {\n        const addPlaylistTracksUrl = \"\".concat(searchBase, \"users/\").concat(userID, \"/playlists/\").concat(playlistID, \"/tracks\");\n        fetch(addPlaylistTracksUrl, {\n          method: 'POST',\n          headers: headers,\n          body: JSON.stringify({\n            uris: trackUris\n          })\n        });\n      });\n    });\n  }\n\n};\nexport default Spotify;","map":{"version":3,"sources":["/Users/aamnv/js/reactjs/c-fdev/jammming/src/util/Spotify.js"],"names":["accessToken","clientID","redirectURI","getAccessTokenURL","Spotify","getAccessToken","accessTokenMatch","window","location","href","match","expiresInMatch","expirationTime","setTimeout","history","pushState","search","term","fetchURL","headerInfo","headers","Authorization","fetch","then","response","ok","json","Error","networkError","console","log","message","jsonResponse","tracks","items","map","track","id","name","artist","artists","album","uri","savePlaylist","trackUris","length","searchURL","searchBase","userID","playlistID","createPlaylistUrl","method","body","JSON","stringify","addPlaylistTracksUrl","uris"],"mappings":"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","sourcesContent":["let accessToken;\nconst clientID ='02e90f8fca6543a8beebe5ca56462a41';\nconst redirectURI = 'http://localhost:3000/';\nconst getAccessTokenURL = `https://accounts.spotify.com/authorize?client_id=${clientID}&response_type=token&scope=playlist-modify-public&redirect_uri=${redirectURI}`\n\n\nconst Spotify = {\n\n\tgetAccessToken() {\n\t\tif (accessToken) {\n\t\t\treturn accessToken;\n\t\t}\n\n    const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\n    const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\n\n    if (accessTokenMatch && expiresInMatch) {\n      let accessToken = accessTokenMatch[1];\n      let expirationTime = expiresInMatch[1];\n      window.setTimeout(() => accessToken = '', expirationTime * 1000);\n      window.history.pushState('Access Token', null, '/');\n\n      return accessToken;\n\n    } else {\n      window.location= getAccessTokenURL\n    }\n  },\n\n  search(term) {\n\n    accessToken = Spotify.getAccessToken();\n\n    if (accessToken) {\n      const fetchURL = `https://api.spotify.com/v1/search?type=track&q=${term}`;\n      const headerInfo = {headers: {Authorization: `Bearer ${accessToken}`}};\n\n      return fetch(fetchURL, headerInfo)\n        .then(\n          response =>  {\n            if (response.ok) {\n              return response.json();\n            }\n            throw new Error('Search request response failed!');\n          }, networkError => console.log(networkError.message)\n        )\n        .then(\n           jsonResponse => {\n            if (!jsonResponse.tracks) {\n              return [];\n            } else {\n              return jsonResponse.tracks.items.map(track => {\n                return {\n                  id: track.id,\n                  name: track.name,\n                  artist: track.artists[0].name,\n                  album: track.album.name,\n                  uri: track.uri\n                }\n              });\n            }\n          }\n        )\n    }\n    else {\n      console.log('Failure to get access token in search');\n    }\n  },\n\n  savePlaylist(name, trackUris) {\n      if (!name || !trackUris || trackUris.length === 0) return;\n      const searchURL = searchBase + 'me';\n      const headers = {\n        Authorization: `Bearer ${accessToken}`\n      };\n      let userID;\n      let playlistID;\n      fetch(searchURL, {\n        headers: headers\n      })\n      .then(response => response.json())\n      .then(jsonResponse => userID = jsonResponse.id)\n      .then(() => {\n        const createPlaylistUrl = `${searchBase}users/${userID}/playlists`;\n        fetch(createPlaylistUrl, {\n            method: 'POST',\n            headers: headers,\n            body: JSON.stringify({\n              name: name\n            })\n          })\n          .then(response => response.json())\n          .then(jsonResponse => playlistID = jsonResponse.id)\n          .then(() => {\n            const addPlaylistTracksUrl = `${searchBase}users/${userID}/playlists/${playlistID}/tracks`;\n            fetch(addPlaylistTracksUrl, {\n              method: 'POST',\n              headers: headers,\n              body: JSON.stringify({\n                uris: trackUris\n              })\n            });\n          })\n      })\n  }\n}\n\nexport default Spotify;"]},"metadata":{},"sourceType":"module"}